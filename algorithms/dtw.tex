\subsection{Алгоритм динамической трансформации временной шкалы (DTW)}

Основная идея алгоритма DTW - минимизация эффекта сдвигов и искажений сигналов во времени путём трансформации одного временного ряда в другой. Это позволяет находить сигналы схожих форм с разными фазами\cite{dtw_review}. 

Пусть даны два временных ряда $X=x_1,x_2...x_N$ и $Y=y_1,y_2...y_M$. Элементы этих рядов $x_i,y_j$ принадлежат одному пространству $\Phi$, для которого введена метрика $d: \Phi \times \Phi \to R$. 

Алгоритм DTW заключается в следующем:

\begin{enumerate}
\item Строится матрица $D$, состоящая из значений метрик для всех возможных пар элементов рядов: $d_{ij}=|| x_i-y_j ||$. Эта метрика показывает величину трансформации одной точки в другую
\item Строится матрица трансформаций $T$:

$t_{ij}=d_{ij}+min(T_{i-1,j-1},T_{i-1,j},T_{i,j-1})$. 

Эта матрица позволяет найти локальные оптимальные пути трансформаций для последовательностей соседних точек. Матрица заполняется, начиная с верхнего левого угла (т.е. с начальных элементов рядов)
\item Наконец, находится такая последовательность индексов $w_k=(i,j)_k$, что:
  \begin{itemize}
  \item начальный индекс - (1,1), конечный - (N,M)
  \item $i_{k+1}-i_k \leq 1, j_{k+1}-j_k \leq 1$ - условие непрерывности пути
  \item последовательности индексов $i, j$ не убывают (путь не возвращается в пройденные точки)
  \item суммарный вес $d_{ij}$ минимален среди всех допустимых вариантов
  \end{itemize}
\end{enumerate}

Результат работы алгоритма - оптимальный путь трансформации одного временного ряда в другой. Длина пути (суммарный вес элементов $d_k$, входящих в него), используется как метрика расстояния между рядами. 

Время работы алгоритма - $O(M*N)$, так как в худшем случае необходимо проверить все пары точек рядов; существуют различные оптимизации, ускоряющие его работу.

\missing{изображения}
