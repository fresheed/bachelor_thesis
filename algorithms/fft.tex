\subsection{Выделение признаков частотной области}

Рассмотренные выше методы пользовались представлением сигнала как последовательности векторов. Между тем, большую информацию может предоставить спектр сигнала. Для его получения воспользуемся дискретным преобразованием Фурье (\defn{ДПФ})\cite{fft_alg}:

$S_k=\sum\limits_{i=0}^{N-1}s_i*exp(-j\dfrac{2\pi}{N}ik), k=0..N-1$, где $S_k$ - комплексные коэффициенты Фурье, $s_i$ - отсчёты сигнала.

Видно, что сложность расчёта спектра - $O(N^2)$ (суммирование $N$ точек сигнала для каждой из $N$ точек спектра). Для ускорения расчётов применяют подвид ДПФ - быстрое преобразование Фурье (\defn{БПФ}). Оно основано на том, что выполнение БПФ над $2M$ точками можно свести к двум независимым БПФ размерности $M$ и их объединению. 

Приведём один из таких алгоритмов - прореживание по времени \cite{fft_alg}. Пусть $y_i=s_{2i}$ и $z_i=s_{2i+1}$ - последовательности из чётных и нечётных элементов исходного ряда соответственно. Тогда

$S_k=\sum\limits_{i=0}^{N/2-1}y_i*exp(-j\dfrac{2\pi}{N}2ik)+\sum\limits_{i=0}^{N/2-1}z_i*exp(-j\dfrac{2\pi}{N}(2i+1)k)=\sum\limits_{i=0}^{N/2-1}y_i*exp(-j\dfrac{2\pi}{N/2}2k)+exp(-j\dfrac{2\pi}{N}k)\sum\limits_{i=0}^{N/2-1}z_i*exp(-j\dfrac{2\pi}{N/2}ik)$.

Таким образом, получили два ДПФ размерности $N/2$. Искомое ДПФ выражается как 
$S_k=Y_k+exp(-j\dfrac{2\pi}{N}k)Z_k$. Так как ДПФ размерности $N/2$ даёт $N/2$ коэффициентов, воспользуемся свойством периодичности спектра: $Y_{i+N/2}=Y_i, Z_{i+N/2}=Z_i$; следовательно, коэффициенты $S_{N/2}..S_{N}$ будут равны соответственно $S_{1}..S_{N/2-1}$. 

Схему, выполняющую соответствующие вычисления, можно представить следующим образом:

\pastepic{Вычисление N-точечного ДПФ через два N/2-точечных}{algorithms/fft.png}{fft}

На каждое половинное ДПФ выполняется $N^2/4$ операций; кроме того, производится $N/2$ умножений на комплексную экспоненту. В итоге такой алгоритм требует $2*N^2/4+N/2=N(N+1)/2$ операций - практически вдвое меньше, чем обычное ДПФ. Если $N$ является степенью двойки, то такое деление можно выполнять на каждом шаге и, таким образом, свести число операций к $N*log_2(N)$, что при больших $N$ даёт существенный прирост производительности.

В качестве выделяемых признаков можно использовать непосредственно спектральные коэффициенты или другие характеристики частотной области, которые можно из них получить.

Применение ДПФ в чистом виде может не дать достаточно показательные признаки. Дело в том, что, зная только состав частот в сигнале, мы теряем информацию о том, в какие моменты времени эти частоты встречались сигналы. Пример такого сигнала и его спектра представлен на \ref{fig:different_freqs}.

\pastepic{Сигнал, состоящий из нескольких отрезков с разными частотами на каждой}{design/different_freqs.png}{different_freqs}

В данном сигнале есть четыре частотные компоненты, каждая из которых действует на протяжении короткого отрезка времени. Зная только его спектр, невозможно сказать, в какой момент времени какая частота была активна в сигнале. Следовательно, для корректного анализа таких сигналов необходимо учитывать как спектр, так и момент времени, для которого производится расчёт. 

Такое преобразование называется \defn{оконным преобразованием Фурье (Short-time Fourier transform)} и представляется следующим образом:

$S_k(m)=\sum\limits_{i=0}^{N-1} s_i*W_{i-m}-*exp(-j\dfrac{2\pi}{N}ik), k=0..N-1$, где $W_{i-m}$ - коэффициенты оконной функции, а $m$ - её сдвиг относительно сигнала. С её помощью происходит выделение конкретных участков сигнала, и ДПФ производится уже над сигналом $s_i*W_{i-m}$. Таким образом, спектр сигнала становится функцией от времени (переменной $m$). Это позволяет анализировать сигналы, подобные приведённому на рис. \ref{fig:different_freqs}\cite{wavelet_tutorial}. В результате оконного преобразование получается спектрограмма - трёхмерный график, показывающий зависимость спектральной плотности сигнала от времени (см. рис. \ref{fig:spectrogram})\cite{spectrogram}. По горизонтальной оси - время, по вертикальной - частота, а цвет показывает мощность соответствующей частоты в этот момент времени.

\pastepic{Пример спектрограммы}{algorithms/spectrogram.png}{spectrogram}

При применении оконного преобразования мы сталкиваемся со следующей проблемой. При увеличении ширины окна мы теряем информацию о временной составляющей (при максимально возможном окне получаем обычное БПФ без информации о времени). При снижении ширины окна мы теряем информацию о спектральной составляющей: разрешающая способность ДПФ равна $df=F_s/N$, где $F_s$ - частота дискретизации, а $N$ - количество точек; так как $df$ обратно пропорционально $N$, при сужении окна разрешающая способность ухудшается. Поэтому необходимо соблюдать баланс между этими видами информации. 

\pastepic{Сигнал с кратковременным высокочастотным пиком}{design/peak_signal.png}{peak_signal}

При этом многие сигналы на практике имеют долговременные низкочастотные составляющие и кратковременные высокочастотные (см. рис \ref{fig:peak_signal}\cite{wavelet_tutorial}). В этом случае наиболее эффективно было бы улучшить разрешающую способность по частоте для отрезков с низкой частотой, а на участках с высокочастотными составляющими повысить разрешение по времени. 

Именно для этого был разработан алгоритм \defn{вейвлет-преобразования}. Его алгоритм можно описать следующим образом:

\begin{enumerate}
\item Исходный сигнал пропускается через два параллельных фильтра - низкочастотный и высокочастотный. Эту операцию можно представить свёрткой сигнала и импульсной характеристики фильтра: $s_{n~high}=\sum\limits_{k=\ninf}^{\pinf}s_kg_{n-k}$, $s_{n~low}=\sum\limits_{k=\ninf}^{\pinf}s_kh_{n-k}$. 

В виде матричной операции это представляется умножением вектора сигнала на матрицу преобразования фильтра. 

Полученные сигналы имеют частотные диапазоны $0..f_{max}/2$ и $f_{max}/2..f_{max}$.
\item Каждый второй отсчёт с выходов фильтров можно отбросить, т.к. частотный диапазон каждого из них составляет половину исходного, и по теореме Котельникова это не приведёт к потере информации. При этом повышается разрешение по частоте (т.к. диапазон частот уменьшается) и снижается разрешение по времени (т.к. отсчёты теперь расположены реже)
\item Сигнал с выхода низкочастотного фильтра подвергается шагам 1 и 2, в результате чего получается ещё два сигнала, которые соответствуют частотным диапазонам $0..f_{max}/4$ и $f_{max}/4..f_{max}/2$. При этом разрешение по частоте продолжает возрастать за счёт снижения разрешения по времени
\item Обработка сигнала фильтрами продолжается до тех пор, пока не будет получено требуемое разрешение по частоте
\end{enumerate}



Схему преобразования представлена на рис.\ref{fig:wavelet_scheme}\cite{wavelet_structure}:

\pastepic{Схема дискретного вейвлет-преобразования}{design/wavelet_scheme.png}{wavelet_scheme}


